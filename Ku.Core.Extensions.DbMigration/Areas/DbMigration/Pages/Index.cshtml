@page "{handler?}"
@model Ku.Core.Extensions.DbMigration.DbMigration.Pages.IndexModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>DbMigration</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="~/lib/layui/css/layui.css" />
</head>
<body>
    <div class="layui-container">
        <div class="layui-row">
            <div class="layui-collapse">
                @foreach (var typ in Model.Types)
                {
                    <div class="layui-colla-item">
                        <h2 class="layui-colla-title">@typ.FullName</h2>
                        <div class="layui-colla-content">
                            <div>
                                <button class="layui-btn layui-btn-sm btn-load" data-guid="@typ.GUID" data-poco="@typ.FullName" data-assembly="@typ.Assembly.FullName">加载</button>
                            </div>
                            <table class="layui-table" id="table_@typ.GUID">
                            </table>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
    <script src="~/lib/layui/layui.all.js"></script>
    <script>
        layui.use('table', function () {
            var table = layui.table;
            var $ = layui.$;

            $(".btn-load").on("click", function () {
                var guid = $(this).attr("data-guid");
                var poco = $(this).attr("data-poco");
                var assembly = $(this).attr("data-assembly");
                table.render({
                    elem: '#table_' + guid
                    , url: 'Index/Data?poco=' + poco + "&assembly=" + assembly //数据接口
                    , page: false
                    , cols: [[ //表头
                        { field: 'Name', title: '字段', width: 200 }
                        , { field: 'Description', title: '说明', width: 200 }
                        , { field: 'Type', title: '类型', width: 120 }
                        , { field: 'Nullable', title: '可空', width: 80 }
                        , { field: 'IsKey', title: '主键', width: 80 }
                    ]]
                });
            });
        });
    </script>
</body>
</html>
